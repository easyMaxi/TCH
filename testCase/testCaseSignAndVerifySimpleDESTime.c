const char *testCaseSignAndVerifySimpleDESTimeDependencies[] = {"C_Initialize", "C_Finalize", "C_GetSlotList", "C_SignInit", "C_Sign", "C_VerifyInit", "C_Verify", "C_GenerateKey", NULL};


int
signDES(CK_BYTE_PTR data, CK_OBJECT_HANDLE_PTR hKey, CK_SESSION_HANDLE_PTR hSession)
{
	CK_RV rv;
	
	CK_BYTE_PTR dataSign = NULL_PTR;
	CK_ULONG dataSignLen = 0;
	
	CK_MECHANISM signMechanism = {
		CKM_DES_MAC, NULL_PTR, 0
	};
	
	//SignInit
	rv = pFunctionList->C_SignInit(*hSession, &signMechanism, *hKey);
	if(rv != CKR_OK)
	{
		returnTestCase(rv, 1);
		return 0;
	}
	
	//Sign NULL_PTR
	rv = pFunctionList->C_Sign(*hSession, data, strlen((char *)data), NULL_PTR, &dataSignLen);
	if(rv != CKR_OK) returnTestCase(rv, 0);
	
	dataSign = malloc(dataSignLen * sizeof(CK_BYTE));
	
	//Sign
	rv = pFunctionList->C_Sign(*hSession, data, strlen((char *)data), dataSign, &dataSignLen);
	if(rv != CKR_OK) returnTestCase(rv, 0);
	
	free(dataSign);
	
	return 0;
}

int
testCaseSignAndVerifySimpleDESTime()
{
	CK_RV rv;
	CK_ULONG ulTokenCount = 0;
	CK_SLOT_ID_PTR pTokenList = NULL_PTR;
	CK_SLOT_ID slotID;
	CK_BYTE application = 42;
	CK_NOTIFY myNotify = NULL;
	CK_SESSION_HANDLE hSession;
	CK_MECHANISM keyMechanism = {
		CKM_DES_KEY_GEN, NULL_PTR, 0
	};
	CK_OBJECT_HANDLE hKey = 0;
	CK_BYTE dataSmall[] = "c0cf7ea915c97b306e8bd4dcf68b6e4f5e38ec8090c829c346559fac5f612813ec60ffeb29e74df3db8a23715d5e9d0c3f7364c3f82c2d73d331ce7405baa925";
	CK_BYTE dataMedium[] = "c1fd6bc4a1b2ac7012ce101f79a0d2558b501a4e487f2a4fffc6df366778ca820010ce360d021dd54aa4c0d398811376c9913f443b935c5350915272193c0caa291f05beb2c5e7bb42b76712e597e6cd84422af2b5648a4c34d75f80767f5cf063a5c0b312adaf07284cc5a189e5b9ec022d4503cd2c0ad53f15e36d22683f5ae5a0e63021046269b4edd9bebadcf1ea76199affaf7aa64f6bfc64f37a23b001e19669bf183f9ad72ee8a17453b85289240edb1548ff93785d8746f35a46502a6647d47b103a4cf863e8949ba576c2f33df69a2c652b2887872f6780048fb17d0471d5a2be3e186d989cad6b4279f70b87ba6c1a47f450400518ebe2be62cc24801fcb782a9aaa50ad5d6708b91a249823b635fce113bf4c87813a681259c003ae8d65ee97a3502129159ff6f5ef35952b035596dce9cb9c19758af9433733b3094d0d5c5c8fdd269df322c42817f7f3ea2240266f9585703903bf7f8e6389006471d93e2917a9e35f077a7b08613dd0b1a6ad94da4f72de1a4ef5b9cd4228da386a9daacdd5867024bbc6c68b34a041abbf480b810ce203e335e46335517612b89433c553ffeaa23b8baf7789fc99f9a87fc16625b38a15fcf6d2a7ace8f729625693c7dd3cf014f3eb62147597f859aff561b702d3a2a53a3408f57782652e4f121ed218bf0f2c95f1a23da61a738f4192bd4d0b4d16f7c011297b42104245be0d34a83d00520222282601b5ecd8397bb0730cbfc3e90d9ae8700ff07115a96e4ce346562686da7d7ed822ec75bf337511e5ffffa7758cdfa50fa9ccfdf2cb484d969246e5c89245cb36c6faf8d0e0d5b804cd6bad9a8636e1ffaae11fed4d267a01f946c85d3e7c7c8e1c321327d899f11271800679b5dd633caa27cfea70c34c30fd79e37877fdacbf29a369800ae3efa3ed90274549835623c52d9660f135debd076f51cdc4db0cbb2920ef0a7e036a8bd511d2cf5a3df300ceeb3fa6bc032f4ca27203aefad7d2dbf0060a02195c5ff8f6c3db226948e87c37a87c2ac0fc9694e2318f4d9fa38506c964fcac434b939a2f2f0030039ef2ec85699808fe880564fbb3cfee62b42e279b586d50989f296827bb4d12eb44c7a23f43318aeb77293cf5efb8df5a4a23c6eb6e5bde51d930e24b7f2412733dbbe2baf200f3d6fe001bbad32eda1bdc83f65dd6f857f2e12abc305f254d31b97694705d80a30a5e462fa7dd911ffbfe9dcb5f8e23498471f3b887121f023eea9f628c54a42d177655262fe497d4f7b007375ee6a715445678e0683cb789f0b0297edf6a5e9059180c84dcdac282839392a4909617e6c5eeefa6a640d6b33751c7859fcbb739b720efefed679feda1663d475e7cf1b5e539056fdeb56a6992e9c33b2b77001080be6497621fe50171d64a14c53aec83717208954165447dc3871ba5e2dcca236b";
	CK_BYTE dataBig[] = "20846ed8e37ba290cdf0f5d757383abfd58de7a30d960e7d69757520ed2ddebc938410e82290cad60e8849f2d09d3207e0e61ce18405e6db5f384dbc70f563df1ded27f1e34952860cd70e3ee93520a202a30b145c5381c5583b4a74b4d1a1a5f5cf7c40c8b17ce42d09dfad277d923294d0230a1c6b19d3130067f8b1e8c63da7d862746ab67ef4fcad27273e3f14dceeb970bae0d44eb3b6b8e91b034249bff570a2bacdf671300a1c3d9c47565894be4de4007f4bc5b536305173bbda360155cc7256d7fe164f7634c81b610ffe0ad57f9fb35c0e429155e205f21d2226ea16c7acc8e1e151b1dae60f6429224d1ed782b89d2b8f0fa23a262530d7a3d0c2fc0e864f9cc183f50a98cf0be735175cdc5c9084c595bf1c7846328f42428f89e9dd08db525954c9d6e5deb9521e0345a98d3db06c802ac0ac1019a2b5653ae030f70e6b15fd5f9b9c4eb0b1ab4772806eed5093fd21d5f3c880d8e4f06329903f1f23d6d4bb2c33324f3858e00f48868af747b3855b76bd6432c34f38c4dec456896d3e3228be7c8df617f7f8ef7be96da10a5c9cfeaaabc20a0ab71a741c6814887d5bf4135ff51487c8e0e4e361aeae5f357585e4a14a7a27928110ebb145b1a43a980b7395994f25a86fa8c30f0b08c8142745df603c354653e2f2c146706a9476cc67fc83cd0e2bd51ea935807a0ada9750512b5a1ff02f4851ac14e33e6a9a08e0d6aa687bf33d55ab4775b19643360963ff4348138bc3779a750b3f0343abe370d4f02f5b8c4d14996fd1238d0e55506053aa03ff2bfd1441862275d8f64ee376942e4d2d52d0b3e43012ff91aa2a4c0fb841306c59e7cf8b55dff4f4fb172b7bce28d2894a2bacbed3403d0be153d9c24c95fe907ad33ebd2d0363d1fd41339efed11dac7fe81fec52a6c2393c0a85cffbbf6e04a1be2b776ddcfa247a1210e295bfd52262fd0caf2b6b0b5bd04e1e7faad03ed77dd3c90e3cd2fbe0e8a9e32c19af12cfc53d9dcc67e0dd23d3dcc36df02947509a173baf842fde78531afdee034cf258d0ad11481cb58dcff04af7db45cd5c6e65b32208df5448d1426c185232434b675f78b0f38e0e1cb1f3d0db020f3a4fdd3c9b81cce046c1a90b1a99c83c701182289c56ff5978ddac90df2bb05b86d72a397ff3570c5f978d9a47dbedaa949abe8f6503856eb654f442c5c8bd09bbfecd97656b6c0ac301b049e4f089f3d6304ee79fd9a0d66731e7084ad7fbddf027a49b754e75a83f153400b326e41205bbcb00b2d2cdae28ccea121f783d7f71a9facc7afebca3b1631230e9b1e818f5d28a61b708f766e87b0d7b5ba66b220bbddb635cc4a0a0a447d1ff37ed7c38e5b8a050ed61d6606df855da5fa4496c425edf3fa6f0ca3a49bf66a2362f5c2781a8097266a72a5e78c0895f6b44db452eb3fc7a3f7500227405bd31ec41164509faa923975e98edc67a88fa54b28ae87bdac710da09e94ac25acc237e11e34630fc87ed2ea67fca58d4ba254f12e389a045e9844bfdf33ad78588c4fbfb3ab9b4dd90308eb0f211ad047a9ddca7b9740ac33f49519233a7e2bfda800c92357321319f5a9f9ed66f3c311bc0edc482a7f9fa447e9a2b76e0df0b80cd6dc07c199f958de6099b1be747082f5246b9f30a04a14287fbe7300c75b0b260c3f0fe96ed34d9810bb76a3ce3daf4285d210f20df04a075c055c6c9086dd2697a01215c8eb14ec9480ae77dc1b1e7b88728752c0fc3667631fc9834686ddbfba67f8cd6d9337b3e8c1c047aa70d1d05e443fa67efedb279a699542c36f7b45a1cb3ffc54ad110ada76acf721f69cff389758a83e47038cfd505cbecc274cc2eefa19459d823b7d611aabe94407e844ec9a1514d95513db70cbeefdb8c37d99645ede244d8de28bc81c2e66cdb9b8f655f84dc701fbb3a9970d0a0aa9b99af93f0721a948ee0c8080d94f727e1df971e943dffbd9142c484c5462f903ac76be600fe4ff400bd2c82abcf420977b21dbe13388569f27e02d8416503cc77dc04cf6c9f6b181c27eaf966e63e8ced9931634a97debb451f2d8eec4f30b38934fbad830f784925d496ebfc3c34a4a68929e34efaef3faca035b1998328b250f8b3397a5675eb473df6cbbcf70cad98f64cfe65325aeed55f75d85a3b1086123aca49255abf31794df6a8f356b11cc2e4268bf21533b4b5790824861ace3b7e35d19f603209bf5abd23e8d50ebfc87c883a94711e1ea224df5f59a9e89a314acd32e4c554d1e25b1cc3daaf361dabeb6dac440346fc9399d3d7118729d225edf6f80b5770ec4d40d68a86c861a291bf1b9b4d2859126c7c457a4706c14fd5c5a21a0a529b2a39fc0b7038b6efdd9c8e0a7815e8fc8c7f01338103f5e4e372ba47df6911167ab712ca967c643b97f0aaa9933a3ac9c4b0c53d730493fcc710aa2fb4a9d95e6a29f43f569824e2e065b380d6bbca3917b8155641ab96b8a7584dddaf48ad30fba779766c06ea79488af2142449d46e78b471f5dbccbf7191244f41cacd624f6b12d06d74dbc3caddad1cfd02fb350893305e967ddce6a54607e205d0b7477897755d2a1f15b3180d109d0435b616aa0bc3272bd4135be399a3c022729874a74e41402c45b1efcba3b17617f4bc3baad31c2f2fa1c663edbbc1ef64a845cae947e581050fb4df2567a2240bafcfc1859013cbe092702db19f789e09728ea04f098eee9612bfa4fee4d70f7b18d077723a2657b6bb48a39bf816fbe38d16719c987cf571aa489a68fcaa24c91a0f5d536e57901e7f8f9e4c3b1be53f7459375f1cdcc375616fca791fc828bbd7d91484e97a76cd0b7cedcb41a6646b628db11985bad6fad0d7f2c6c1094c5b7e7af508351e833163ca9cb002979c30ba17804ddbbcc5baad79f2e5d26eca423671373fd6d00c94a16ebd48bbb82d323d556c6a7c016c83ec1e37e5f565442b43f9bef50870cb5387cae48459829abb8e638455d770eb4c65c96673179fafdc34c18395646e709b219e3735023e48b49a6e23f3521e3e5250afb9217c23a5e733b75fb55a3d2bd43c497f847d12035e3ce11591b0f380068dc403192d04b7eb75f74ecf664f981188e258d57c5ae57896355aa28d6752cc9b5496d09859d7fd88c6b82022eece34d15f92cb0ed43686c2a84f1f4e369d001cc6cc2b4531e8e8349bef8bcd6890eedaa2b737304454116532fce8c856c7e577a6e5c3b442a7c82495b6f90c51c9cdf69a4d4ac6a8b73d2ada0e52b0c480aba403bdfc3c62275a7baa264814664f3ab6d8ff1dff7c079b56d0505fa73f9ba729efb965fa468b04db66f6cdf19d25d395783acfc9fdfe4f6551c94dec7366e228fc5c4696a184f0fd204ee965b2430a8eaada6e7f131d8abd92258ee7da75d21469bdaa267cbf068ceac15611ea9b3869e0815231850b41d423800e95d2213613716143ff7f04b29261295dcfd332de2f3c35b9aad97d87414186973a6062a5a4ae41418c46c595f67d709e6f739df46fba9de323a538b9d25970e967766e1396a617279aba69dac3aadf3fdeed14eebb98d5edab7cfb9623f4beda53bf09dc0042ff0c283472f49488b1f76f6602f01c7731484763e6ed566f4e7803002fe7919d8f0731b844840ef7c39a533b9b09481dc0b1b45dcf709a868787ef938c35483e741c1c07e11d71aaefaabcfdedea64d7f555374d0474a5cb6479818bfa4f47343dce023aab22f485b58ee07207f61617c571bd8035294cfc04e35e9bf0fe7e347fbbf9239b62751e636a3c426280d340c77bf7bcf44a8c1d3b787714fe012413ef01068a015ab43275ccde251f4d7f04ab6d6d01d574a2ac91de2bfd186653d03c48bd1cfa259b60ca04a1ff4da54cffa4b954161d07d1897005e0a544d4e6b382996bc7177b003db0845d17199c4fd5374443fd695bcb7eceb4222c4d30a63e2b9bd9a9bd41d97383a293df0b8296089e8318a1a9c6b8b209128890cc357a7f493f23d1ca6762b0b9298abeba1ec74b5665fb66d0f8f156a3a906126c0122a4bcb405902f46d23e6683443b3e403e3a5b8cdedbc742a4a5bd8918f9cbf7a2e38e4d0e55210aa94a42870fb46437c114b01734308e316035a9f80424c9446e89fa825a6d36485f561072be7cb696833e6811b2de5388f2591c96bd347f7db45e0f93a3802a1551a1702cfda034bb0a28fc14106e80378f242542c0a9204625d6befa3ed30861f9e1cc6130b138eb24f04aea4d4bc6417266f120519db3c9e45d523cd5d16d23c7d96d5daf30fb5b205b9d889b5c64f6d6222d495f8bf5b95689f51d913c10f43980cbd860b0be0b275d21ef1e90eebc4e59e96de69c4e0703b7d92648e24e6d0f56c98dd0e4510e6a231868859e96375bf1920b2ace0dec275e74b480b08cb5b1bad4bacb22cd46e138c833067a9f0e96a3ec760d30ee2fcdc6051e142a9c95f165036b58861f942b48d29f1bad9a3cb951fb61a0b9feac414e74fc26840d885942a1ca1cdd28ecf74f01980b4b186b61f840ccea41c67195aaa3fcf0eb446fcb3fd089fa6364595251f01c8ca1f4fb8038adad7f72e1359b2d56af93f3a7ecbc826f20b7b7178aa9e425ffd38cdadf4164e88ee5afb7e4d31a0d3d2287dc16601d2c6dd7552fd6f9de0e396a155cba641b467c52386971ec706063364ef4f4df653e772cd16afeb6805a4acb27663a68a5a58c75aa186b6f856d30b4e53eafe3f27bae55b9fb8d42b41c870e8534cc0e73c56a950ea3c7be6c07d3a2807ced338439d6f2a9b7ace8775cf70f2d3d45cbe0061f48c2349b7166b7f8b82280395fa7d2b0efafb4580a747518dc11d8362cf2d8a5c186d95286f93d1abb22701232fa56febef464f7ecb0fed1a853563ecedf141a07f44f44eb3f6bf18ffa7028ac0195b30787cd5236ab09efacf2197c0854e501c913c3c0145252c6a2bf99f2ea006dffefd22eea40925c300acd1cc0351958a8c96df821ab5675bc1c12fabba7f69c605bc9852c9106e2c2d4aa58b3e0663b4a6c310dc0c18ef8f1fbf17032c76404d1ce8f52323d59457d6750a290a7a2bb9f05e231c8918a28208a8a44d3753cde06a7ae83f65dfef2227ca6957c94d2ff1aefb4ba58391dd1036530c70f65cd359c44ce5aad82f7e860d463119852d11e267f32388670c82d39f67fb32f282d48260c394de130ebf5a6e0e42478c7a42bcfe29b7c7f838d3606ad3f967e942533f557ab1e8d5727abfe17e631d093cc513e4ec8e072748b014e6e6c2218a691fdde9a5c060fd0a7b5b4ecd63985ea31490a4fb52ee8efc64290a5d5235b78ec264ab014ea77f8b67e383be1e9caea3a5bc437d99fda68692a69f29524fefbc8a8a977b18d755d69c6221b6ac9afa4128ddea5b12aed9772736936c0c540b9f74547f2e8ea5cd3558f658e5dc410656a86d972bc63802819e5cf0cbcbdf7b53379ad4870da4d8b4db8176c0caf86777fc2b8a1ef905f200e808a8521f2fa3799394181e4425440ae8fe843b15785a844b470f352a6afa47a82b71e0952c9807c44c00cd0d3e5dcd3faee9f5dad09b7731c8816017f11e8b68015433e1b1642983a043957d12b4476dcff5c9135ab9f0eda1fab32fc089efbd80e56aeb6b80f5e3d3963cfd27afaedf762cec6df68f17c2489d0fe7150a5e23a540777d8629caf7dc5d4d208a03994312095df31df11c2cd6a286a2fb9a1b1da87f46f3a28988860d9b052ac33ee37faf967dd3bed0949e70df64934cb77d99d1949feb8474a6a113f46af9b858cf4cf5dc0c80790f6eccb2fb9c2eb4844b61f80899ada289b5428cd729218b1904cbe3a7897dff5a67fa82e6b2d6c579ad87fe67ecf4d886a8178b14d8b9af0883cdeb1c162d23bc5866126bb5531603f5bc328a7ff39968f37063b4f2438236325897ac81c13d9306d085ec33ab96806bb8064c5ad427d654fcc93917fd5670c01f309499bee0d5203c723935bf4a52fcb011c10547beab4d1c82270acf1de4ac6694f7b1a5e862789a081a0300e85b644cab31e2be0689bbe0f16f70ef9ddf5e9fee983fbf461575bdced89b305a2c5afee4a26fa8723d474d73e202cf40dee18cfb4003ffe09e036b47e965104b615bb8c185aa7093264c4333f3a11b01e6c8ad7d233e1db725e1f68a37904d492c14397b3dd66d60b388a01e9e41986d2e544ea611aab1a9275e72b28be68323b64ef2c64b2029d7653aff17739c231cf384e93ed66d95a9619618564846e3e418fe0ee2e95ac12516d3506293b2c92af98789246808fcad05804c06e40cb39c0f8897300bd6392ea34486403aff1865969d62d882e8414a5888c7b7263ce2525442b8cb8826e4a8baecdc0a2bbe637a7e147ab885f10c20091105305126e1800dd6d0f266b5c614706878016eace1de6e3a56e9e2477cfb23e9a8e7d85621dd5f43a7af456374b1b8a393952453c107acf9ea1b857f14190bdf099e704c2dd0f4b330a23ffbb30288c80654e6b65b75cf97873371fde83945cb840e072c01531c47fc6b2eb356b8c738a1a59be633a38721de7891c166ea51710ac5cfb79e7a04ffc9aed54c89ef656b1a68c57c2f74bc187653289c315be677498c318a597f0354d9cf8f9c6cacb3d937fab327b607844398b408a81356498b9519cd2d9e9ecee9846ae880de8c58c38f69f9c6bcf888a98645a5c16b362272e7e64b6ba78ad605d14d3f004ef0cc03efc6facb877376aefb15a0994cdefed5ce5765220d67cf4c8798d938799092eadcb0fc3bf2ed007b4b17100078da3f419fc04311535cc18c718693d1d5fbbd6f43d06313613bd6d1bf237d604f4194e264df99abd07160ce47d6b34f40b9349af748d1e5f6e0fb87bfb697c200baa7159b8eb3195be3c9553d9ec1358e930713ddbacc9bb69104b6a74c7b31c528478ebb456222a1828676e2485e599ae386e7ac9c16b85b43db64af12420eab9c82a6915e413a0223de3cdb5ad98d1b214ed21201bdf0379fa3b7500f3d9e8333e618ae3b0c15901cedcc6b36455255b3d69d9cf2e94dd9ea52876cbb386a87555ca864647e1092f8bbad3012a4c58eef85c1b147e358dac04c7921b055b54670e7095984f39540a60afc9c08d1cf27917a8f995d41f024269e6d7197c24d796e9e227940f353a0b28cbd0035c8f69c8b7be617a20e26ff9c337e0e3d11e793732ca71c15d380235f69769be1220bf6a7c3c4a269f036e76931fd43084591b85fa4eca2ddf5d1cdbeb2ce52a3a616522848eb4bf64d476e488f2ec618809cc92a9aaee3ba5bc018eee2a76d005fd03b14db2113361efa34c0da4298ff04b7394ea91d19cf4e94cac1052ea2fe4e91c39334286253ca6d0dc5cc72d274fdc68a90c75e1970110ef7b4d72de5ccc14fda65ee9c0ae667df7918f96c95d56f7eb0d96469c920ce337f2dabd158d92b2ecc9b3a7b114f27822026461175bc2cc34c5b968cc795551c346551b9a35b67b7e487ffd79dd735146db50e30bd94f9c0caa11d9a5369fd30c1764ba7bcc00258602be19eee64815ea244466d77fdbcd392fbbfac55e8df8a992de87d3381f4560d7771149f5676cdd122f64e73df57203b9380ee27d392665949dcba5f63365834e95d73cdf7e89225c502b5b6bd366739bf7e44f1ae3424dbbe3e4ac598886d99a10e8308e375403a5c53ba66cab303d573187999eb4223569e95101d7cd2a9c2acbb33bbfb9071bcca26ba9cc528743b67f5fafd82c0d6bb3ad0ae6069811d2213df11962ced98d561995b41c1c6b1af112d3be334f34b73e45d12b842a57ef7a151cfcce2f7036d596f83b7005446a1b833cadbe87c12143893b1a9bd1c3c5e450c6c68ab6d4d324356ac6adab6841a6826ddcde0fe8ed541122f961117370851bdde96d596a3d9ceac783183cf6becf80a7d9a4d3ebbeed51acdff19b888fe85f099e52e416510e1b45fc1689a9d95a5207d6d4e8f9b90aac9b98cacb545154cda6328c221d837273f452555f59d58e50214fddd78858683d41c288ad55bb209c3d6482332fe174f180e612855ef72deff6a3a63eb3bcfb8e47c9866600cb3e1aa61b51ad803d7d01cdd3da51259a1a5ac815f072aff7f9b49137ed72e59e874420d176ec121957d6ed91dcc423f6b9ac01660094b5948b39821f860199e5f06ede90fa28a511cf35838f98e4ad6de3a65d28e1c2bee9ec02514cd6638857069fad7a7295d506d0668ea8d1e3422f9da2318dcca164740fcfcad69aa80cc2e0f12dc042ff4637b28192aca6fce6885f2f6e30a5807ec86a2c19bddf186399129b1dde1665280900b5cd4a5a7271d1890f9b52ff8dc9b5ad27ef021a4c7ef17e96ee6d46eee515e81e6368032d40169ea0ea79f5128378b61b6a96260c1bda0363b8f1fe2c2bbe5c1275d447cbc5b82ad596de84178a6d9ccd037a346d8487a3212bef1a461ebd3258efb1e720e5f370e0134785282d24cbd4eb552316a58a7624a05aaaf4807795a013fb9a70c60c9edb26f1edb776e6b991a1c5d4f1de735584c63c38ef7c1a755b5e4f713f24538499b3d24fd0fa87c62c93b282e5d21482ef65fd611cf667eb7f30b40282a04d5bb5d41c235291526bc78cfd723f262489646a30cbcbccbc306250d6d6cf28a4ebac244e56fff939bbf9f2f9c649ca525b8a9a07cae5b527f8d6d752db957f24c98572cb2779003030702f3fbb9d392b1fc296f3ca387abcaf8c9454c7ce87f64a86a829453c61ba3e13fa2ae9ff83b616991d13e162698275389c2a860092d15923f553548ad2b7fa527faaf33a65e32ec75297dd402b49a022af0105d48be3cfcfb11acb5db10c94d19edf3495922ad347083c070005655886d24c25d6e264f2a4ec89883243a38e961fe97e893eab7bb6fd70fb3318432cc10fbfc72cd582cd0338221e589752ee77429cbea5457e15b2afe6dc7909be02d132275a9f959f42100872ee4990faba704a017f3e15e0173f35601fb4c2a86605847bd9fb51f268f051566ad6d25bf15627e17a36e902bf4b4b1c2ea478ddf773aa1a36057deda10ac05abcaf9095fb394d2943f3fcf293986b68b3e7fdf79240f6588d5cfbb28de86682d4f1245e51a6309f983aabf6da6d4c0f54123dea937f9506e79cf7b502f6a610cf2c337e5f990b5842fc5763d6d84b2e4cca8aeea067615432b3b6e98889d1f151785db38ea4019c71217de2fa22c25fe6dee6c72e6866ed5fb2bdc220fe609b69d3d40c6de683a59f994541ec7e18f8e6c3810784a47c629067d5104df9534fed76d7be806059268e42eb6ea2fd88cc552bce9f9badc6e56ede8dc265573333629122ccf2bb174e07197e187c717c1cddd7facd813b82656704893af4bff407b6a795ea15bf8701dbca48e3d75dc1079725e8bbd7aa1593e36915a8e7db56f23377847e23aa3cfc49aff10c42dd2dbe8d0150cd4f30238ee714980e7e61c0204015149cc5f41d11ed430e92c6259721258c0e085abd4fc67317fd941f7b616bd7834c69adf5e469d59a627d384979e06942e2c7230ff23dfd94ba66fb6ac6e9e89756648e42981f4c392d92ff8a02373c35d5e19b357aff09967aadcb7a2ee966c5fd8945104919e7c90e4c3349f3549cc2fa90bc0ed6db11a9ae29c2fb6589dfa479bf6a66c6b2ddca2285c09673a7c30bbb0b6c50bfb92db364eafb9a40f438eaaa79e6f19b8a3849ae779c1e9edb6603284d828a4cca8212c48ad9b40aab55e98027155a50accdafc25719e2120e4bab086cc3d0194a99922a46363371e080ba2e879a5b50c4f610dae04a900afdf030f402ec8830760ed0085e9fa594c58ceb65e9e62f7d135cc72d97f4995412afbb7fd5a5f7739384a941f44dcf2a025983ecb9e390d514605bcc3110df4d80840a6c219efbf5afebf76d8328c575facaf7a59d2331d7566a36881cdbb5811b19d914601c074776565112268155d1b206066c6d6eb27dbffad35b6c82bbb996a77ef5b1c03465ca4f4390e48247930795b5d125e16d838be97dd90c3413f6bb2d76938a718c2e1490cecf3ebc7471f0a99ef0f296713575f9363cc9baf5e4381195a95a37af7ab2cf990dcf8ca61402f073140e224e4488051d30fc43c56beb2fc528e9563f29ba01ede8a1c128beaec6cc87beb34affe2e04d8eed4ef9d3a56ece0d99236918fc0a1f94834ef81ebb999d5b6510deb5a0485e625a22af06df860d1d6acb2fa7194a68c44e602f5fbb95f92f4369568f72cffa9f970956acb1116d1c76cadc6aae96e3994afcaad7cd4a7fab2f97039407a56e59b7479c27f5b69b2daf024f750d1a157ed0eeedb4c31620fa4c889ef9dcbdc304f4c74d2397f0a89dcded1f0ed4048ba657bf896281273eefdc1cf09e4354ebd63880594c76d92bb40943196f02553f589d498578be8927fa59678a48d760f80063b678e166168304ba61a6d17660dfcf5206d33f0ed033c373855a5c1b4466bb8b53d17c08b1a03048756b73b0d523558c25a5c0dd1876c8ad7d424d811c8188b2456e3a6fe7979bacc82d70b7cef90f8d55b2a32496cc630215b950d2c87a4e9fafc62de32b6fdbd83dd50460ac025a960f5da7eea52cbb8450a05cd856729abc9f08c360fd428cab0455ab03ea269dd13c583ddf9835379a9bbdd6d5057fba499d4700991cba59a348e5ab13e1eae4f37a3a30679d03739f09151ec34a83b61bed467285be9a2684660c907e654d0b3a8556f1238f6e0bcd31944abaebdab02e1c7700d0a49eec9e51290eacd528c96a2494024e5530b4a841336d5965c6c59e87fca9699adcfea5475d3fdfcfcf873c78538b04daafde8eb09fcf7d8f6d6d600f13678f299043067de212f282ed5de167d7a2157310cfc8525a8a55da3de04f93f882845e81f95b06a4bb55dc3d0da242abd23f4c7caf4700e8bd7f174ce38920ea580a4553ac771da52d64ae59e71fa42d0eab04538a584e36e4c55fb1de304911e79813b9a01944c9314c965c9535a667bc6fca1d526c388bfddb7e677304a23f82b70e7fa61e6fb5e09f30d715dbf371a7475afd0af1585503098afadf8ae8650e73ae7a9d83d40f87b5d3ddd2e27f92ce2a3be8f5c61a6a887dd96c07f93854f5dc605ef5a9710237e15c62d37f712b54ca2482de0218eacfdd6c64b453a2b2f0ad0f8576b23a958c7650341eff0042bd8c2d02a1ce9a0f62de1a14f81cafdcc208618b8dcc78525b71995b96c55d088a01b226ba02391292806c49b88c71e3b47781498ee8171ab72aef94ea23821956ca82ec49626b3dc999c0b601f5b56f75d0dbc9cd872e7672cb7e0a6115cef871bd7d1d309cc93e96bf1d95d6dfb59ae8686b3645da9796ec514aa8b7ec0a6535723398681f123b7668a82f44094bcf52957b9268ea0dc1078a24f7c75eafe61dbfc7fe0bc969710d8e9089615056acc15c2fd9d6238d7b95dbf20c4e21eb5b671c6e50395b0e2fe508a82191f2f17b5a0313a31593db898fb9ed24be3625bc1e80304257b2d98584859cb61cb42609ed78c955d62fa09e4936b41536a03bf76b7c161a29407d769fdec6bb514e260ef2964a383dfb3fd0e9e8b4c80a41c56b73";
	clock_t start;

	
	int i;
		
	printf("Testing case: SignAndVerifySimpleDESTime ...\n");
	printf(" Check dependencies ...\n");
	if(checkDependecies(testCaseSignAndVerifySimpleDESDependencies) != 1) return CKR_FUNCTION_NOT_SUPPORTED;
	printf(" Dependencies are fine\n");
	
	//initialize
	printf(" call Initialize ...");
	rv = pFunctionList->C_Initialize(NULL_PTR);
	if(rv != CKR_OK) returnTestCase(rv, 0);
	else printf(" success\n");
	
	//GetSlotList -> Tokenlist
	findActiveTokens(&pTokenList, &ulTokenCount);
	
	for(i=0;i<ulTokenCount;i++)
	{
		slotID = pTokenList[i];
		
		//OpenSession with CKF_SERIAL_SESSION
		printf(" call C_OpenSession on slot %lu with CKF_SERIAL_SESSION...", slotID);
		rv = pFunctionList->C_OpenSession(slotID, CKF_SERIAL_SESSION, (CK_VOID_PTR) &application, myNotify, &hSession);
		if(rv != CKR_OK) returnTestCase(rv, 0);
		else printf(" success\n");
		
		if(sArguments.uPin)
		{
			//Login
			printf(" call C_Login on slot %lu as User ...", slotID);
			rv = pFunctionList->C_Login(hSession, CKU_USER, (CK_UTF8CHAR_PTR) sArguments.uPin, strlen(sArguments.uPin));
			if(rv != CKR_OK) exit(EXIT_FAILURE);
			else printf(" success\n");	
		}
		
		generateKey(&keyMechanism, &hKey, &hSession);
			
		printf(" sign \n");
		
		start = time(NULL);
		signDES(dataSmall, &hKey, &hSession);
		printf("  Could sign %zu CK_BYTEs in %f sec.\n", strlen((char *) dataSmall), (double)(time(NULL) - start));
		
		start = time(NULL);
		signDES(dataMedium, &hKey, &hSession);
		printf("  Could sign %zu CK_BYTEs in %f sec.\n", strlen((char *) dataMedium), (double)(time(NULL) - start));
		
		start = time(NULL);
		signDES(dataBig, &hKey, &hSession);
		printf("  Could sign %zu CK_BYTEs in %f sec.\n", strlen((char *) dataBig), (double)(time(NULL) - start));



		if(sArguments.uPin)
		{
			//Logout
			printf(" call C_Logout on slot %lu ...", slotID);
			rv = pFunctionList->C_Logout(hSession);
			if(rv != CKR_OK) returnTestCase(rv, 0);
			else printf(" success\n");		
		}
	}
	
	//finalize
	printf(" call Finalize ...");
	rv = pFunctionList->C_Finalize(NULL_PTR);
	if(rv != CKR_OK) returnTestCase(rv, 0);
	else printf(" success\n");
	
	free(pTokenList);

	printf(" ... case successful\n");
	
	return CKR_OK;
}
